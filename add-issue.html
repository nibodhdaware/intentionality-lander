<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Report a problem - Intentionality</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
        />
        <link rel="icon" type="image/png" sizes="16x16" href="icon16.png" />
        <!-- Firebase App (the core Firebase SDK) -->
        <script src="/lib/firebase-app-compat.js"></script>
        <!-- Firebase Firestore -->
        <script src="/lib/firebase-firestore-compat.js"></script>
        <!-- Firebase config -->
        <script src="/lib/firebase-config.js"></script>
        <script>
            tailwind.config = {
                darkMode: "media",
                theme: {
                    extend: {
                        colors: {
                            deepblue: "#18344A", // background
                            medblue: "#295B7A", // eye
                            lightblue: "#4A90A4", // eye ring
                            darkbg: "#0f1a2a", // dark mode background
                            darktext: "#e2e8f0", // dark mode text
                        },
                    },
                },
            };
        </script>
        <style>
            body {
                background: #18344a;
            }
            .google-btn {
                background: #fff;
                color: #444;
                border: 1px solid #e0e0e0;
                font-weight: 600;
                transition: box-shadow 0.2s, border-color 0.2s;
            }
            .google-btn:hover {
                box-shadow: 0 2px 8px rgba(66, 133, 244, 0.15);
                border-color: #4285f4;
                color: #4285f4;
            }
            .google-btn.dark {
                background: #1e293b;
                color: #e2e8f0;
                border: 1px solid #334155;
            }
            .google-btn.dark:hover {
                box-shadow: 0 2px 8px rgba(66, 133, 244, 0.15);
                border-color: #4285f4;
                color: #4285f4;
            }
            .google-icon {
                color: #4285f4;
            }
            /* Dark mode transitions */
            * {
                transition: background-color 0.3s ease, color 0.3s ease,
                    border-color 0.3s ease;
            }
        </style>
    </head>
    <body class="min-h-screen flex items-center justify-center">
        <div
            class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-lg flex flex-col items-center dark:bg-darkbg dark:text-darktext"
        >
            <h1
                class="text-2xl font-bold text-deepblue mb-2 dark:text-darktext"
            >
                Report a Problem
            </h1>
            <p
                class="text-gray-600 mb-6 text-center text-base dark:text-gray-300"
            >
                If you encounter any issues or have suggestions, please let us
                know. Your feedback is important to us!
            </p>
            <input
                type="text"
                id="issueTitle"
                class="w-full p-3 border border-gray-300 rounded-lg mb-4 dark:bg-darkbg dark:text-darktext dark:border-gray-600"
                placeholder="Issue Title"
            />
            <textarea
                id="issue"
                class="w-full p-3 border border-gray-300 rounded-lg mb-4 dark:bg-darkbg dark:text-darktext dark:border-gray-600"
                rows="4"
                placeholder="Describe the issue or suggestion..."
            ></textarea>
            <button
                id="submitIssueButton"
                class="google-btn w-full flex items-center justify-center gap-3 py-2.5 px-4 rounded-lg text-base mb-4 dark:google-btn-dark"
            >
                <span>Submit issue</span>
            </button>
            <a
                href="index.html"
                class="google-btn w-full flex items-center justify-center gap-3 py-2.5 px-4 rounded-lg text-base mb-4 dark:google-btn-dark"
            >
                <i class="fas fa-arrow-left"></i>
                Back to Home
            </a>
            <div
                id="issueStatus"
                class="text-green-600 font-semibold text-center mt-4 dark:text-green-400"
            ></div>
        </div>
        <script>
            document
                .getElementById("submitIssueButton")
                .addEventListener("click", async function () {
                    const issueTitle =
                        document.getElementById("issueTitle").value;
                    if (issueTitle.trim() === "") {
                        alert("Please enter an issue title.");
                        return;
                    }
                    const issueDescription =
                        document.getElementById("issue").value;
                    if (issueDescription.trim() === "") {
                        alert("Please describe the issue or suggestion.");
                        return;
                    }

                    // Save to Firestore
                    try {
                        if (
                            typeof firebase === "undefined" ||
                            !firebase.firestore
                        ) {
                            throw new Error("Firebase not available");
                        }
                        await firebase.firestore().collection("issues").add({
                            title: issueTitle,
                            description: issueDescription,
                            timestamp: new Date(),
                            userAgent: navigator.userAgent,
                        });
                        document.getElementById("issueStatus").innerText =
                            "Issue submitted successfully!";
                        document.getElementById("issueTitle").value = "";
                        document.getElementById("issue").value = "";

                        // TODO: Add notification logic here (email, webhook, etc.)
                    } catch (error) {
                        document.getElementById("issueStatus").innerText =
                            "Failed to submit issue. Please try again.";
                        console.error("Error submitting issue:", error);
                    }
                });
        </script>
    </body>
</html>
